---
import Base from "../../layouts/Base.astro";
import ProductDirectory from "../../components/ProductDirectory.tsx";
import products from "../../data/products.json";

const pageTitle = "Browse Products";
const title = `${pageTitle} â€¢ Vitamin Brand Checklist`;
const description = "Search vitamins and supplements, and filter by common categories.";
const canonical = "https://vitaminbrandindex.com/products/";
---

<Base {title} {description} {canonical}>
  <main>
    <header class="page-header">
      <h1>{pageTitle}</h1>
      <p class="lead">{description}</p>
    </header>

    <section class="directory">
      <ProductDirectory client:load products={products} initialQuery={Astro.url.searchParams.get("q") ?? ""} />
    </section>
  </main>

  <!-- JSON-LD ItemList for Products -->
  <script type="application/ld+json">
    {JSON.stringify({
      "@context": "https://schema.org",
      "@type": "ItemList",
      itemListElement: (products || []).map((p, i) => ({
        "@type": "ListItem",
        position: i + 1,
        url: `https://vitaminbrandindex.com/products/${p.slug}/`,
      })),
    })}
  </script>
</Base>
