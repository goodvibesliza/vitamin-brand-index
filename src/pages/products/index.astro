---
import Base from "../../layouts/Base.astro";
import ProductDirectory from "../../components/ProductDirectory.tsx";
import products from "../../data/products.json";

const pageTitle = "Browse Products";
const title = `${pageTitle} â€¢ Vitamin Brand Checklist`;
const description = "Search vitamins and supplements, and filter by common categories.";
const canonical = "https://vitaminbrandindex.com/products/";
---

<Base {title} {description} {canonical}>
  <main>
    <header class="page-header">
      <h1>{pageTitle}</h1>
      <p class="lead">{description}</p>
    </header>

    <section class="directory">
      <ProductDirectory client:load products={products} initialQuery={Astro.url.searchParams.get("q") ?? ""} />
    </section>
  </main>

  <style>
      :root {
        --bg: #ffffff;
        --text: #111314;
        --muted: #6b7280;
        --border: #e5e7eb;
        --accent: #0ea5e9;
        --accent-weak: #e0f2fe;
      }
      html, body { margin: 0; padding: 0; background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
      .page-header { padding: 2rem 1rem 1rem; max-width: 1000px; margin: 0 auto; }
      .page-header h1 { margin: 0 0 .25rem; font-size: 2rem; }
      .lead { margin: 0; color: var(--muted); }
      .directory { max-width: 1000px; margin: 0 auto; padding: 1rem; }

      /* Basic card/grid */
      .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 1rem; }
      .card { border: 1px solid var(--border); border-radius: 10px; padding: 0.875rem; background: #fff; }
      .card h3 { margin: 0 0 .25rem; font-size: 1rem; }
      .card p { margin: 0; color: var(--muted); font-size: 0.9rem; }

      .controls { display: grid; gap: 0.75rem; border: 1px solid var(--border); border-radius: 10px; padding: 0.75rem; margin-bottom: 1rem; }
      .searchbar { display: flex; gap: 0.5rem; }
      .searchbar input[type="search"] {
        flex: 1; padding: 0.6rem 0.75rem; border: 1px solid var(--border); border-radius: 8px; font-size: 1rem;
      }
      .counts { font-size: 0.9rem; color: var(--muted); }

      .filters { display: flex; gap: 1rem; flex-wrap: wrap; }
      .filter-group { min-width: 240px; }
      .filter-badge {
        display: inline-block; padding: .25rem .5rem; border-radius: 999px; border: 1px solid var(--border);
        background: var(--accent-weak); color: #0369a1; font-size: .85rem; margin-right: .5rem; margin-bottom: .5rem;
      }
      .actions { display: flex; gap: .5rem; align-items: center; }
      button.reset {
        border: 1px solid var(--border); background: #fff; border-radius: 8px; padding: .45rem .7rem; cursor: pointer;
      }
      button.reset:hover { border-color: var(--accent); }
      a.card-link { text-decoration: none; color: inherit; }
      .empty { padding: 1rem; border: 1px dashed var(--border); border-radius: 10px; text-align: center; color: var(--muted); }
  </style>

  <!-- JSON-LD ItemList for Products -->
  <script type="application/ld+json">
    {JSON.stringify({
      "@context": "https://schema.org",
      "@type": "ItemList",
      itemListElement: (products || []).map((p, i) => ({
        "@type": "ListItem",
        position: i + 1,
        url: `https://vitaminbrandindex.com/products/${p.slug}/`,
      })),
    })}
  </script>
</Base>
